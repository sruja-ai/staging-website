const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["_astro/editor.main.DWK_h-lh.js","_astro/index._4BMK3ry.js","_astro/index.C-nSUQJB.js","_astro/auto.qXY55obW.js","_astro/index.CIfVDR44.css"])))=>i.map(i=>d[i]);
import{p as U,r as E}from"./index._4BMK3ry.js";import{c as re,E as W,p as F,v as te,_ as q}from"./auto.qXY55obW.js";import{j as C}from"./jsx-runtime.D_zvdyIk.js";class N extends Error{constructor(r,t){super(r),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"context",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="SrujaError",this.code=t?.code??"UNKNOWN_ERROR",this.context=t?.context,this.cause=t?.cause,Error.captureStackTrace&&Error.captureStackTrace(this,N)}toJSON(){const r={name:this.name,message:this.message,code:this.code,context:this.context,stack:this.stack};return this.cause&&(r.cause={name:this.cause.name,message:this.cause.message,stack:this.cause.stack}),r}}class oe extends N{constructor(r,t){super(r,{code:"VALIDATION_ERROR",context:{...t?.context,field:t?.field,value:t?.value}}),this.name="ValidationError"}}class P extends N{constructor(r,t){super(r,{code:"CONFIGURATION_ERROR",context:{...t?.context,configKey:t?.configKey}}),this.name="ConfigurationError"}}class z extends N{constructor(r,t){super(r,{code:"NETWORK_ERROR",context:{...t?.context,url:t?.url,status:t?.status},cause:t?.cause}),this.name="NetworkError"}}function he(e){return e instanceof N}function _e(e){return e instanceof oe}function ye(e){return e instanceof Error?e.message:typeof e=="string"?e:"Unknown error occurred"}function Se(e){if(e instanceof Error)return e.stack}var ne={};let J=!1,Y;const G=typeof U<"u"&&ne!==void 0&&!0;function ae(){if(J)return!0;if(typeof window<"u"){const e=window.__SRUJA_DEBUG__;if(typeof e=="boolean")return e;try{if(window.localStorage?.getItem("sruja:debug")==="true")return!0}catch{}}return!G}function K(e){return[e.timestamp,`[${e.level.toUpperCase()}]`,e.service?`[${e.service}]`:"",e.message].filter(Boolean).join(" ")}function X(e){const r={timestamp:e.timestamp,level:e.level,message:e.message};return e.service&&(r.service=e.service),e.context&&Object.keys(e.context).length>0&&(r.context=e.context),JSON.stringify(r)}function I(e,r,t){const i=new Date().toISOString(),l={level:e,message:r,context:t,timestamp:i,service:Y};if(e==="error"||e==="warn"){const v=G?X(l):K(l);if(e==="error"){console.error(v,t?JSON.stringify(t,null,2):"");try{const b=(typeof t?.component=="string"?t.component:void 0)||"unknown",u=(typeof t?.action=="string"?t.action:void 0)||"error",p=`error.${b}.${u}`,m={error_message:r,error_type:(typeof t?.errorType=="string"?t.errorType:void 0)||"unknown",...t};typeof window<"u"&&(m.user_agent=navigator.userAgent,m.screen_size=`${window.screen.width}x${window.screen.height}`,m.viewport_size=`${window.innerWidth}x${window.innerHeight}`,m.url=window.location.href.substring(0,200)),re(p,m)}catch{}}else console.warn(v,t?JSON.stringify(t,null,2):"");return}if(!ae())return;const f=G?X(l):K(l);e==="info"?console.info(f,t?JSON.stringify(t,null,2):""):console.debug(f,t?JSON.stringify(t,null,2):"")}const c={setService(e){Y=e},enableDebug(){J=!0},disableDebug(){J=!1},debug(e,r){I("debug",e,r)},info(e,r){I("info",e,r)},warn(e,r){I("warn",e,r)},error(e,r){I("error",e,r)}};function Z(){return typeof window<"u"}function be(){return typeof U<"u"&&U.versions?.node!==void 0}function Ee(){return typeof window>"u"||typeof document>"u"}function se(e){if(!Z())return e?.trailingSlash?"/":"";const r=import.meta;if(r.env?.BASE_URL){const f=r.env.BASE_URL;return e?.trailingSlash?f.endsWith("/")?f:f+"/":f.endsWith("/")?f.slice(0,-1):f}const t=window.location.pathname;if(e?.studioPath!==!1&&(t.startsWith("/studio")||t.startsWith("/docs")))return e?.trailingSlash?"/":"";const i=t.match(/^(\/.+?)\//),l=i?i[1]:"";return e?.trailingSlash?l?l+"/":"/":l}function Q(){return typeof window>"u"?null:window}function V(){try{const e=typeof import.meta<"u"?import.meta:void 0;if(e?.env?.DEV||e?.env?.MODE==="development")return!0}catch{}return typeof U<"u"&&!1}async function ie(e){await new Promise((r,t)=>{const i=document.createElement("script");i.src=e,i.async=!0,i.onload=()=>r(),i.onerror=()=>{const l=new Error("Failed to load "+e);c.error("Failed to load wasm script",{component:"wasm",action:"load_script",scriptUrl:e,error:l.message}),t(l)},document.head.appendChild(i)})}async function H(e,r){const t=Q();if(!t)throw new P("Window object not available",{configKey:"window"});if(t.Go)return;const i=[e,r.replace(/\/?$/,"/")+"wasm_exec.js","/wasm_exec.js","https://cdn.jsdelivr.net/gh/golang/go@go1.25.0/misc/wasm/wasm_exec.js"];let l=!1,f=null;for(const v of i)try{if(await ie(v),t.Go){l=!0;break}}catch(b){f=b instanceof Error?b:new Error(String(b))}if(!l){const v=new z("Failed to load wasm_exec.js from all candidates",{url:e,cause:f||void 0,context:{candidates:i}});throw c.error("Failed to load Go wasm runtime",{component:"wasm",action:"load_go_runtime",candidates:i,error:v.message}),v}}async function ce(e){if(!Z())throw new P("WASM initialization requires browser environment");const r=Q();if(!r)throw new P("Window object not available",{configKey:"window"});const t=e?.base||"/",i=t.replace(/\/?$/,"/")+"wasm/wasm_exec.js",l=t.replace(/\/?$/,"/")+"wasm/sruja.wasm",v=V()?Date.now():`v${Date.now()}`,b=l+"?v="+v;if(!e?.skipGoLoad)await H(i,t);else if(!r.Go)try{await H(i,t)}catch{}const u=r.Go;if(!u){const n=new P("wasm_exec.js not loaded - Go constructor not available",{configKey:"Go"});throw c.error("Go constructor missing",{component:"wasm",action:"init",errorType:"go_constructor_missing",error:n.message}),n}const p=new u,m=p.importObject||{};if(!m.gojs){const n=m.env||{};m.gojs=Object.keys(n).length?n:m.go||{}}m.gojs&&!m.gojs["runtime.scheduleTimeoutEvent"]&&(m.gojs["runtime.scheduleTimeoutEvent"]=n=>{setTimeout(()=>{try{p._resume&&p._resume()}catch{}},n)});let w=null;const h=[b,l,t.replace(/\/?$/,"/")+"sruja.wasm","/sruja.wasm",t.replace(/\/?$/,"/")+"studio/wasm/sruja.wasm",t.replace(/\/?$/,"/")+"viewer/wasm/sruja.wasm","/wasm/sruja.wasm"];let _=null;for(const n of h)try{const o=await fetch(n);if(!o.ok)throw new z(`Failed to fetch ${n}`,{url:n,status:o.status});if(WebAssembly.instantiateStreaming)try{w=(await WebAssembly.instantiateStreaming(o,m)).instance,_=null,c.info("WASM loaded via streaming",{component:"wasm",action:"load_wasm",url:n}),V()&&console.info(`[WASM] ✅ Loaded from ${n}
[WASM] Cache-busting enabled - new WASM will load automatically after rebuild.
[WASM] If changes don't appear, try a hard refresh (Ctrl+Shift+R / Cmd+Shift+R)`);break}catch(s){c.warn("WASM streaming failed, falling back to arrayBuffer",{component:"wasm",action:"load_wasm",error:s instanceof Error?s.message:String(s)});const a=await fetch(n);if(!a.ok)throw new Error("Failed to re-fetch for fallback");const d=await a.arrayBuffer();w=(await WebAssembly.instantiate(d,m)).instance,_=null,c.info("WASM loaded via arrayBuffer fallback",{component:"wasm",action:"load_wasm",url:n}),V()&&console.info(`[WASM] ✅ Loaded from ${n} (fallback method)
[WASM] Cache-busting enabled - new WASM will load automatically after rebuild.
[WASM] If changes don't appear, try a hard refresh (Ctrl+Shift+R / Cmd+Shift+R)`);break}else{const s=await o.arrayBuffer();w=(await WebAssembly.instantiate(s,m)).instance,_=null,c.info("WASM loaded via arrayBuffer",{component:"wasm",action:"load_wasm",url:n}),V()&&console.info(`[WASM] ✅ Loaded from ${n}
[WASM] Cache-busting enabled - new WASM will load automatically after rebuild.
[WASM] If changes don't appear, try a hard refresh (Ctrl+Shift+R / Cmd+Shift+R)`);break}}catch(o){_=o instanceof Error?o:new Error(String(o));continue}if(!w){const n=_||new z("Failed to load sruja.wasm from all candidates",{context:{candidates:h}});throw c.error("Failed to load sruja.wasm",{component:"wasm",action:"load_wasm",errorType:"wasm_load_failure",candidates:h,retries:h.length,error:n.message}),n}p.run(w),await new Promise(n=>setTimeout(n,100));let M=0;const R=150;for(;!r.sruja_dsl_to_model&&M<R;)await new Promise(n=>setTimeout(n,50)),M++;if(M>=R){const n=Object.keys(r).filter(o=>o.startsWith("sruja_"));c.error("Required WASM functions not found after waiting",{component:"wasm",action:"wait_for_required",retries:M,available:n,missing:{model:!r.sruja_dsl_to_model,mermaid:!r.sruja_dsl_to_mermaid,markdown:!r.sruja_dsl_to_markdown}})}const S=r.sruja_dsl_to_mermaid,A=r.sruja_dsl_to_markdown,y=r.sruja_dsl_to_model,g=r.sruja_model_to_dsl,O=r.sruja_dsl_to_dot,x=r.sruja_analyze_governance,D=Object.keys(r).filter(n=>n.startsWith("sruja_"));if(c.info("WASM functions loaded",{component:"wasm",action:"init_complete",available:D}),!S||!A||!y||!g){const n=[];S||n.push("sruja_dsl_to_mermaid"),A||n.push("sruja_dsl_to_markdown"),y||n.push("sruja_dsl_to_model"),g||n.push("sruja_model_to_dsl");const o=Object.keys(r).filter(a=>a.startsWith("sruja_")),s=new P(`WASM functions not found. Missing: ${n.join(", ")}. Available: ${o.join(", ")||"none"}`,{configKey:"wasm_functions",context:{missing:n,available:o,retries:M}});throw c.error("WASM functions missing",{component:"wasm",action:"init",errorType:"wasm_functions_missing",missing:n,available:o,retries:M,windowKeys:Object.keys(r).filter(a=>a.includes("sruja")||a.includes("wasm")),error:s.message}),s}return{parseDslToJson:async(n,o)=>{try{const s=o||typeof location<"u"&&location.pathname||"input.sruja";if(!y)throw new W("SYSTEM_5002","sruja_dsl_to_model function not registered");const a=y(n,s);if(!a||!a.ok){const d=F(a);throw d?(c.error("WASM parse failed",{component:"wasm",action:"parse_dsl",errorType:"parse_failure",errorCode:d.code,error:d.message,context:d.context,dslLength:n.length}),d):new W("PARSE_1001",a?.error||"parse failed")}return a.json||a.data||""}catch(s){throw c.error("WASM parse exception",{component:"wasm",action:"parse_dsl",errorType:"parse_exception",error:s instanceof Error?s.message:String(s),errorCode:s instanceof W?s.code:void 0}),s}},modelToDsl:async n=>{try{if(!g)throw new W("SYSTEM_5002","sruja_model_to_dsl function not registered");const o=g(n);if(!o||!o.ok){const s=F(o);throw s||new W("EXPORT_4001",o?.error||"model to DSL conversion failed")}return o.data||""}catch(o){throw c.error("WASM model to DSL exception",{component:"wasm",action:"model_to_dsl",error:o instanceof Error?o.message:String(o),errorCode:o instanceof W?o.code:void 0}),o}},dslToMermaid:async(n,o,s)=>{try{const d=S(n,JSON.stringify({viewLevel:o??1,targetId:s??""}));if(!d||!d.ok){const k=F(d);throw k?(c.error("WASM mermaid export failed",{component:"wasm",action:"export_mermaid",error:k.message,errorCode:k.code,context:k.context,dslPreview:n.substring(0,200)}),k):new W("EXPORT_4001",d?.error||"mermaid export failed")}const j=d.data||"";if(!j||j.trim().length===0){const k="mermaid exporter returned empty output";throw c.error("WASM mermaid export returned empty",{component:"wasm",action:"export_mermaid",error:k,dslPreview:n.substring(0,200)}),new W("EXPORT_4002",k)}return j}catch(a){throw c.error("WASM mermaid export exception",{component:"wasm",action:"export_mermaid",error:a instanceof Error?a.message:String(a),errorCode:a instanceof W?a.code:void 0}),a}},dslToMarkdown:async n=>{try{const o=A(n);if(!o||!o.ok)throw new Error(o?.error||"markdown export failed");return o.data||""}catch(o){throw c.error("WASM markdown export exception",{component:"wasm",action:"export_markdown",error:o instanceof Error?o.message:String(o)}),o}},dslToModel:async(n,o)=>{try{const s=o||typeof location<"u"&&location.pathname||"input.sruja";if(!y)throw new W("SYSTEM_5002","sruja_dsl_to_model function not registered");const a=y(n,s);if(!a||!a.ok){const d=F(a);throw d||new W("EXPORT_4001",a?.error||"model export failed")}return a.data||""}catch(s){throw c.error("WASM model export exception",{component:"wasm",action:"export_model",error:s instanceof Error?s.message:String(s),errorCode:s instanceof W?s.code:void 0}),s}},dslToDot:async(n,o,s,a)=>{try{if(!O)throw new W("SYSTEM_5002","sruja_dsl_to_dot function not registered");const j=O(n,JSON.stringify({viewLevel:o??1,focusNodeId:s??"",nodeSizes:a||{}}));if(!j||!j.ok){const k=F(j);throw k||new W("EXPORT_4001",j?.error||"DOT export failed")}return te(j.data)}catch(d){throw c.error("WASM DOT export exception",{component:"wasm",action:"export_dot",error:d instanceof Error?d.message:String(d),errorCode:d instanceof W?d.code:void 0}),d}},calculateArchitectureScore:async n=>{try{if(!x)throw new Error("sruja_analyze_governance function not registered");const o=x(n);if(!o||!o.ok)throw new Error(o?.error||"score calculation failed");return JSON.parse(o.data||"{}")}catch(o){throw c.error("WASM score calculation exception",{component:"wasm",action:"calculate_score",error:o instanceof Error?o.message:String(o)}),o}}}}let L=null,B=null;function ue(){return se({trailingSlash:!0,studioPath:!0})}async function le(e){return L||B||(B=(async()=>{const r=e?.base??ue();return L=await ce({...e,base:r}),L})(),B)}async function $(){if(L)return L;try{return await le()}catch(e){return c.error("Failed to initialize WASM",{component:"wasm",action:"get_api",error:e instanceof Error?e.message:String(e)}),null}}async function ve(e,r){const t=await $();if(!t)return c.error("WASM not available",{component:"wasm",action:"convert_dsl_to_json"}),null;try{const i=await t.parseDslToJson(e,r);return JSON.parse(i)}catch(i){const l=i instanceof Error?i.message:String(i);throw c.error("DSL parse error",{component:"wasm",action:"convert_dsl_to_json",error:l,filename:r||"unknown"}),new Error(`Failed to parse DSL${r?` (${r})`:""}: ${l}`)}}async function Me(e){const r=await $();if(!r)return c.error("WASM not available",{component:"wasm",action:"convert_dsl_to_markdown"}),null;try{return await r.dslToMarkdown(e)}catch(t){return c.error("DSL to Markdown conversion error",{component:"wasm",action:"convert_dsl_to_markdown",error:t instanceof Error?t.message:String(t)}),null}}async function je(e){const r=await $();if(!r)return c.error("WASM not available",{component:"wasm",action:"convert_dsl_to_mermaid"}),null;try{return await r.dslToMermaid(e)}catch(t){return c.error("DSL to Mermaid conversion error",{component:"wasm",action:"convert_dsl_to_mermaid",error:t instanceof Error?t.message:String(t)}),null}}async function ke(e,r,t,i){const l=await $();if(!l)return c.error("WASM not available",{component:"wasm",action:"convert_dsl_to_dot"}),null;try{return await l.dslToDot(e,r,t,i)}catch(f){return c.error("DSL to DOT conversion error",{component:"wasm",action:"convert_dsl_to_dot",error:f instanceof Error?f.message:String(f)}),null}}async function We(e){const r=await $();if(!r)throw c.error("WASM not available",{component:"wasm",action:"convert_model_to_dsl"}),new Error("WASM not available");try{const t=JSON.stringify(e);return await r.modelToDsl(t)}catch(t){const i=t instanceof Error?t.message:String(t);throw c.error("Model to DSL conversion error",{component:"wasm",action:"convert_model_to_dsl",error:i}),t}}function ee(e){e.languages.register({id:"sruja"}),e.languages.setMonarchTokensProvider("sruja",{tokenizer:{root:[[/\/\/.*$/,"comment"],[/\/\*[\s\S]*?\*\//,"comment"],[/"([^"\\]|\\.)*$/,"string.invalid"],[/"/,{token:"string.quote",bracket:"@open",next:"@string"}],[/\d+\.\d+/,"number.float"],[/\d+/,"number"],[/\b(workspace|model|views|system|component|container|import|relation|requirements|adrs|functional|nonfunctional|constraint|true|false)\b/,"keyword"],[/->/,"operator"],[/[:=]/,"operator"],[/[{}]/,"delimiter.bracket"],[/[[\]]/,"delimiter.array"],[/[(),]/,"delimiter"],[/[a-zA-Z_][a-zA-Z0-9_]*/,"identifier"],[/\s+/,"white"]],string:[[/[^\\"]+/,"string"],[/\\./,"string.escape.invalid"],[/"/,{token:"string.quote",bracket:"@close",next:"@pop"}]]}}),e.languages.setLanguageConfiguration("sruja",{comments:{lineComment:"//",blockComment:["/*","*/"]},brackets:[["{","}"],["[","]"],["(",")"]],autoClosingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:'"',close:'"'}],surroundingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:'"',close:'"'}],indentationRules:{increaseIndentPattern:/^.*\{[^}]*$/,decreaseIndentPattern:/^\s*\}/}})}function de({value:e,onChange:r,language:t="plaintext",theme:i="vs",height:l="100%",options:f={},className:v,onReady:b}){const u=E.useRef(null),p=E.useRef(null),m=E.useRef(null),w=E.useRef(null),h=E.useRef(!0),_=E.useRef(e),[M,R]=E.useState(!1);E.useEffect(()=>{_.current=e},[e]),E.useEffect(()=>{if(typeof window>"u"||p.current)return;let y=!0,g=null,O=null,x=null;typeof window.MonacoEnvironment>"u"&&(window.MonacoEnvironment={getWorker:function(n,o){const s=new Blob(["self.onmessage = () => {}"],{type:"application/javascript"});return new Worker(URL.createObjectURL(s))}});const D=()=>{if(!y)return;const n=u.current;if(!n){x=setTimeout(D,50);return}try{if(!n.parentNode||!n.isConnected||!document.body.contains(n)){x=setTimeout(D,50);return}}catch{x=setTimeout(D,50);return}q(()=>import("./editor.main.DWK_h-lh.js").then(o=>o.e),__vite__mapDeps([0,1,2,3,4])).then(o=>{if(!y)return;const s=u.current;try{if(!s||!s.parentNode||!s.isConnected||!document.body.contains(s))return}catch{return}m.current=o;try{t==="sruja"&&ee(o)}catch(a){const d=a instanceof Error?a.message:String(a);c.warn("Failed to register language",{component:"MonacoEditor",action:"registerLanguage",language:t,error:d});return}if(u.current){try{if(!u.current.parentNode||!u.current.isConnected||!document.body.contains(u.current))return}catch{return}try{const a={value:_.current,language:t,automaticLayout:!0,minimap:{enabled:!1},theme:i,scrollBeyondLastLine:!1,foldingHighlight:!0,foldingImportsByDefault:!1,unfoldOnClickAfterEndOfLine:!0,accessibilitySupport:"on",...f,folding:f.folding!==!1,foldingStrategy:f.foldingStrategy||"indentation",showFoldingControls:f.showFoldingControls||"always"};g=o.editor.create(u.current,a);const d=g.getValue();w.current=d,h.current=!1,g&&setTimeout(()=>{try{g?.layout()}catch{}},100);const j=()=>{const T=u.current?.querySelector(".editor-widget.find-widget");T&&T.querySelector(":focus")&&T.getAttribute("aria-hidden")==="true"&&T.removeAttribute("aria-hidden")},k=new MutationObserver(()=>{j()});u.current&&(k.observe(u.current,{attributes:!0,attributeFilter:["aria-hidden"],subtree:!0}),u.current.addEventListener("focusin",j,!0),u.current.addEventListener("focus",j,!0)),g._ariaObserver=k,g._ariaCleanup=()=>{k.disconnect(),u.current&&(u.current.removeEventListener("focusin",j,!0),u.current.removeEventListener("focus",j,!0))},p.current=g,O=g.onDidChangeModelContent(()=>{if(g&&y){const T=g.getValue();if(T===_.current)return;w.current=T,r(T)}}),b&&y&&b(o,g),y&&R(!0)}catch(a){const d=a instanceof Error?a.message:String(a);c.error("Failed to create Monaco editor",{component:"MonacoEditor",action:"createEditor",error:a instanceof Error?{message:a.message,name:a.name,stack:a.stack}:d})}}}).catch(o=>{const s=o instanceof Error?o.message:String(o);c.error("Failed to load Monaco editor",{component:"MonacoEditor",action:"loadMonaco",error:o instanceof Error?{message:o.message,name:o.name,stack:o.stack}:s})})};return x=setTimeout(D,0),()=>{if(y=!1,x&&(clearTimeout(x),x=null),O&&(O.dispose(),O=null),g){try{g.dispose()}catch{}g=null}if(p.current){try{const n=p.current?._ariaCleanup;n&&n(),p.current.dispose()}catch{}p.current=null,h.current=!0}}},[t,i,r,b,f]),E.useEffect(()=>{const y=p.current;if(!y||h.current||w.current===e)return;y.getValue()!==e?(w.current=e,y.setValue(e)):w.current=e},[e]),E.useEffect(()=>{const y=m.current,g=p.current;!y||!g||y.editor.setTheme(i)},[i]);const S=i==="vs-dark"||i==="hc-black",A={position:"absolute",top:0,left:0,right:0,bottom:0,overflow:"auto",padding:"0",margin:0,fontFamily:"Menlo, Monaco, 'Courier New', monospace",fontSize:"13px",lineHeight:"18px",whiteSpace:"pre",backgroundColor:S?"#1e1e1e":"#ffffff",color:S?"#d4d4d4":"#000000",opacity:M?0:1,pointerEvents:M?"none":"auto",transition:"opacity 0.1s ease-out",zIndex:M?-1:1};return C.jsxs("div",{style:{position:"relative",height:l},className:v,children:[!M&&C.jsx("pre",{style:A,children:e}),C.jsx("div",{ref:u,style:{height:"100%",width:"100%"}})]})}function fe({original:e,modified:r,language:t="plaintext",theme:i="vs",height:l="100%",options:f={},className:v,onReady:b}){const u=E.useRef(null),p=E.useRef(null),m=E.useRef(null);return E.useEffect(()=>{if(typeof window>"u"||p.current)return;let w=!0,h=null,_=null;typeof window.MonacoEnvironment>"u"&&(window.MonacoEnvironment={getWorker:function(R,S){const A=new Blob(["self.onmessage = () => {}"],{type:"application/javascript"});return new Worker(URL.createObjectURL(A))}});const M=()=>{if(!w)return;if(!u.current){_=setTimeout(M,50);return}q(()=>import("./editor.main.DWK_h-lh.js").then(S=>S.e),__vite__mapDeps([0,1,2,3,4])).then(S=>{if(w&&u.current){m.current=S;try{t==="sruja"&&ee(S)}catch(A){console.warn("Failed to register language:",A)}try{const A=S.editor.createModel(e,t),y=S.editor.createModel(r,t),g={theme:i,automaticLayout:!0,readOnly:!0,renderSideBySide:!0,...f};h=S.editor.createDiffEditor(u.current,g),h.setModel({original:A,modified:y}),p.current=h,b&&w&&b(S,h)}catch(A){console.error("Failed to create Monaco diff editor:",A)}}}).catch(S=>{console.error("Failed to load Monaco editor:",S)})};return _=setTimeout(M,0),()=>{w=!1,_&&clearTimeout(_),h&&(h.dispose(),h=null),p.current=null}},[t,i,r,b,f,e]),E.useEffect(()=>{const w=p.current,h=m.current;if(!w||!h)return;const _=w.getModel();_&&(_.original.getValue()!==e&&_.original.setValue(e),_.modified.getValue()!==r&&_.modified.setValue(r))},[e,r]),E.useEffect(()=>{const w=m.current;w&&w.editor.setTheme(i)},[i]),C.jsx("div",{ref:u,className:v,style:{height:l}})}function Ae({value:e,originalValue:r,onChange:t,theme:i="vs",height:l="100%",options:f={},className:v,enableLsp:b=!0,onReady:u}){return r!==void 0?C.jsx(fe,{original:r,modified:e,language:"sruja",theme:i,height:l,options:{...f,readOnly:!1,originalEditable:!1},className:v,onReady:(p,m)=>{u&&u(p,m.getModifiedEditor())}}):C.jsx(de,{value:e,onChange:t,language:"sruja",theme:i,height:l,options:f,className:v,onReady:async(p,m)=>{if(b&&typeof window<"u")try{const{createWasmLspApi:w,initializeMonacoWasmLsp:h}=await q(async()=>{const{createWasmLspApi:M,initializeMonacoWasmLsp:R}=await import("./index.ZJBLZeBO.js");return{createWasmLspApi:M,initializeMonacoWasmLsp:R}},[]),_=w();h(p,m,_)}catch(w){const h=w instanceof Error?w.message:String(w);c.warn("WASM LSP initialization failed",{component:"SrujaMonacoEditor",feature:"lsp",error:h,fallbackMode:!0})}u&&u(p,m)}})}export{P as C,z as N,Ae as S,oe as V,Ee as a,Z as b,Me as c,be as d,N as e,he as f,se as g,_e as h,ce as i,ye as j,Se as k,c as l,le as m,$ as n,ve as o,je as p,ke as q,We as r};
